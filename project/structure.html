<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Optimale du Projet StockGenius XAU</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Gris clair neutre */
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .nav-link {
            padding: 12px 18px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #d1d5db; 
            border-left: 4px solid transparent;
        }
        .nav-link:hover {
            background-color: #374151;
            color: #ffffff;
            border-left-color: #60a5fa;
        }
        .nav-link.active {
            background-color: #1e40af;
            color: #ffffff;
            font-weight: 600;
            border-left-color: #2563eb;
            box-shadow: 0 4px 14px rgba(30, 64, 175, 0.2);
        }
        .nav-link.font-semibold.active { /* Pour les titres de section principaux */
             background-color: #1d4ed8; 
        }
        .nav-link.ml-4.active { /* Pour les sous-sections */
            background-color: #2563eb; 
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 6px 12px -2px rgba(0, 0, 0, 0.05), 0 3px 7px -3px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        th, td {
            border-bottom: 1px solid #e5e7eb;
            padding: 14px 18px;
            text-align: left;
            font-size: 0.925rem;
        }
        th {
            background-color: #f9fafb;
            font-weight: 600;
            color: #111827;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        td {
            background-color: #ffffff;
            color: #374151;
        }
        tr:last-child td {
            border-bottom: none;
        }
        tr:hover td {
            background-color: #f8f9fa;
        }
        .table-container {
            overflow-x: auto;
        }
        .code-block {
            background-color: #1f2937; 
            color: #d1d5db; 
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'JetBrains Mono', 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            font-size: 0.9rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #374151;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-break: break-all;
        }
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #9ca3af;
            border-radius: 10px;
            border: 2px solid #e5e7eb;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        
        .content-card {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.08), 0 8px 10px -6px rgba(0, 0, 0, 0.08);
            margin-bottom: 2.5rem;
        }
        h2.section-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 2rem;
            color: #1e3a8a;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 0.75rem;
            letter-spacing: -0.025em;
        }
         h3.subsection-title {
            font-size: 1.875rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1.25rem;
            color: #1d4ed8;
        }
         h4.block-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.75rem;
            margin-bottom: 1rem;
            color: #1e40af;
        }
        ul.styled-list {
            list-style: none;
            padding-left: 0;
        }
        ul.styled-list > li {
            position: relative;
            padding-left: 2rem;
            margin-bottom: 0.75rem;
            color: #4b5563;
            line-height: 1.6;
        }
        ul.styled-list > li::before {
            content: "\f058"; 
            font-family: "Font Awesome 6 Free";
            font-weight: 900; 
            position: absolute;
            left: 0;
            top: 5px;
            color: #2563eb;
            font-size: 1rem;
        }
        ul.styled-list ul { /* Pour les listes imbriquées */
            margin-top: 0.5rem;
            padding-left: 1.25rem; /* Moins de padding pour les sous-listes */
        }
        ul.styled-list ul > li::before {
            content: "\f101"; /* Icône de chevron double droit FontAwesome */
            font-size: 0.875rem; /* Taille ajustée pour les sous-listes */
        }
        .dir-structure {
            font-family: 'JetBrains Mono', 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            background-color: #f9fafb; /* Fond clair pour la structure de dossiers */
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            margin-top: 1rem;
            margin-bottom: 1rem;
            color: #374151;
        }
        .dir-structure .folder { color: #0d9488; /* Teal pour les dossiers */ font-weight: 500; }
        .dir-structure .file { color: #64748b; /* Slate pour les fichiers */ }
        .dir-structure .comment { color: #9ca3af; /* Gris pour les commentaires */ font-style: italic; }

        .page-break { page-break-after: always; }
        /* Styles d'impression simples */
        @media print {
            body { font-size: 10pt; line-height: 1.2; background-color: #ffffff !important; }
            aside { display: none !important; }
            main { margin-left: 0 !important; padding: 1cm !important; overflow-y: visible !important; }
            .content-section { display: block !important; margin-bottom: 2cm; }
            h1, h2, h3, h4, h5, h6 { page-break-after: avoid; page-break-inside: avoid; color: #000 !important; }
            table, figure, .code-block, .dir-structure { page-break-inside: avoid; }
            .content-card { background-color: transparent !important; color: #000 !important; border: 1px solid #ccc !important; box-shadow: none !important; border-radius: 0 !important; padding: 1cm;}
            .nav-link { display: none !important; }
            .table-container { overflow-x: visible; }
            .code-block, .dir-structure { background-color: #f0f0f0 !important; color: #000 !important; border: 1px solid #ccc !important;}
            ul.styled-list > li::before { color: #000 !important; }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">
    <div class="flex min-h-screen">
        <aside class="w-80 bg-slate-900 text-slate-100 p-6 space-y-2.5 fixed top-0 left-0 h-full overflow-y-auto print:hidden shadow-2xl">
            <h1 class="text-2xl font-extrabold mb-10 text-blue-400 tracking-tight">Architecture StockGenius</h1>
            <nav id="report-navigation" class="space-y-1.5">
                <a href="#" class="nav-link block" data-target="intro-archi">1. Introduction</a>
                <a href="#" class="nav-link block" data-target="principes-archi">2. Principes Architecturaux</a>
                <a href="#" class="nav-link block" data-target="structure-haut-niveau">3. Structure de Haut Niveau</a>
                <a href="#" class="nav-link block font-semibold" data-target="coeur-src">4. Cœur du Système : <code>src/</code></a>
                <a href="#" class="nav-link block ml-4" data-target="src-common">4.1. <code>common/</code> (Utilitaires)</a>
                <a href="#" class="nav-link block ml-4" data-target="src-data-processing">4.2. <code>data_processing/</code></a>
                <a href="#" class="nav-link block ml-4" data-target="src-ml-models">4.3. <code>ml_models/</code></a>
                <a href="#" class="nav-link block ml-4" data-target="src-trading-strategy">4.4. <code>trading_strategy/</code></a>
                <a href="#" class="nav-link block ml-4" data-target="src-backtesting">4.5. <code>backtesting/</code></a>
                <a href="#" class="nav-link block ml-4" data-target="src-execution">4.6. <code>execution/</code></a>
                <a href="#" class="nav-link block ml-4" data-target="src-main-cli">4.7. <code>main.py / cli.py</code></a>
                <a href="#" class="nav-link block" data-target="gestion-donnees-archi">5. Gestion des Données : <code>data/</code></a>
                <a href="#" class="nav-link block" data-target="configs-secrets">6. Configuration & Secrets : <code>configs/</code></a>
                <a href="#" class="nav-link block" data-target="qualite-repro">7. Qualité et Reproductibilité</a>
                <a href="#" class="nav-link block" data-target="integration-outils-archi">8. Intégration d'Outils</a>
                <a href="#" class="nav-link block" data-target="conclusion-archi">9. Conclusion</a>
            </nav>
        </aside>

        <main class="flex-1 ml-80 p-6 sm:p-8 md:p-12 overflow-y-auto">
            
            <section id="intro-archi" class="content-section active">
                <div class="content-card">
                    <h2 class="section-title">1. Introduction : Architecturer 'StockGenius XAU' pour le Succès</h2>
                    <p class="mb-4 text-slate-700 leading-relaxed text-lg">
                        Pour un système complexe tel que 'StockGenius XAU', qui combine le trading algorithmique avec l'apprentissage automatique (Machine Learning, ML), une architecture méticuleusement planifiée n'est pas un luxe mais une nécessité. Elle sous-tend la viabilité à long terme du projet, sa capacité d'adaptation aux nouvelles conditions de marché ou stratégies, et la faculté de l'équipe à collaborer efficacement.
                    </p>
                    <p class="mb-4 text-slate-700 leading-relaxed text-lg">
                        Une structure bien pensée réduit les bogues, simplifie le débogage et rationalise les mises à jour futures. L'investissement initial en temps dans la conception architecturale est une activité à fort effet de levier, prévenant la "dette technique" et minimisant les risques financiers potentiels dus à des erreurs.
                    </p>
                    <h3 class="subsection-title">Objectifs Principaux de la Structure :</h3>
                    <ul class="styled-list">
                        <li><strong>Maintenabilité :</strong> Code facile à comprendre, modifier et déboguer.</li>
                        <li><strong>Scalabilité :</strong> Adaptation à la croissance (données, complexité, équipe).</li>
                        <li><strong>Reproductibilité :</strong> Essentielle pour les opérations MLOps, garantissant la fiabilité des expériences.</li>
                        <li><strong>Testabilité :</strong> Chaque composant doit être testable isolément et en intégration.</li>
                        <li><strong>Collaboration :</strong> Faciliter le travail d'équipe grâce à une structure claire.</li>
                    </ul>
                </div>
            </section>

            <section id="principes-archi" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">2. Principes Architecturaux Fondamentaux</h2>
                    <p class="mb-6 text-slate-700 leading-relaxed">L'architecture de 'StockGenius XAU' est guidée par un ensemble de principes fondamentaux reconnus pour leur capacité à produire des logiciels robustes, maintenables et évolutifs.</p>
                    
                    <h3 class="subsection-title">Modularité et Séparation des Préoccupations (SoC)</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        La modularité consiste à décomposer le système en composants plus petits, indépendants et réutilisables. La SoC stipule que chaque module doit adresser une responsabilité unique.
                        Pour 'StockGenius XAU', cela simplifie le développement, améliore la maintenabilité, favorise la réutilisabilité et facilite le développement en parallèle. Concrètement : des répertoires distincts pour le traitement des données, la modélisation ML, la logique de stratégie, etc.
                    </p>

                    <h3 class="subsection-title">Architecture Propre (Clean Architecture) et Conception Dirigée par le Domaine (DDD)</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        L'Architecture Propre organise le système en couches (Domaine, Application, Infrastructure) avec des dépendances pointant vers l'intérieur. La couche Domaine (logique métier principale) est au centre, indépendante des frameworks.
                        La DDD met l'accent sur le domaine principal. Pour 'StockGenius XAU', cela signifie comprendre les subtilités des instruments financiers, des stratégies, des risques. Un Langage Ubiquitaire est partagé.
                    </p>

                    <h3 class="subsection-title">Adhésion aux Principes SOLID et DRY</h3>
                    <p class="mb-2 text-slate-700 leading-relaxed"><strong>SOLID :</strong></p>
                    <ul class="styled-list mb-4">
                        <li><strong>S</strong>ingle Responsibility Principle (SRP) : Une classe/module = une seule raison de changer.</li>
                        <li><strong>O</strong>pen/Closed Principle (OCP) : Ouvert à l'extension, fermé à la modification.</li>
                        <li><strong>L</strong>iskov Substitution Principle (LSP) : Les sous-types substituables à leurs types de base.</li>
                        <li><strong>I</strong>nterface Segregation Principle (ISP) : Interfaces spécifiques au client.</li>
                        <li><strong>D</strong>ependency Inversion Principle (DIP) : Dépendre des abstractions, pas des concrétions.</li>
                    </ul>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        <strong>DRY (Don't Repeat Yourself) :</strong> "Chaque élément de connaissance doit avoir une représentation unique, non ambiguë et faisant autorité." Réduire la répétition de code.
                    </p>
                    <p class="text-slate-700 leading-relaxed">
                        Ces principes, appliqués de manière holistique, créent un effet synergique, menant à un système adaptable et résilient.
                    </p>

                    <h3 class="subsection-title">PEP 8 et Conventions de Nommage Cohérentes</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        L'adhésion à PEP 8 pour le style de code Python est cruciale. Les conventions de nommage (<code>snake_case</code> pour variables/fonctions, <code>CamelCase</code> pour classes, <code>ALL_CAPS_SNAKE_CASE</code> pour constantes) doivent être cohérentes et descriptives.
                    </p>
                </div>
            </section>

            <section id="structure-haut-niveau" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">3. Structure de Projet de Haut Niveau Proposée</h2>
                    <p class="mb-4 text-slate-700 leading-relaxed">La racine du projet doit être épurée, contenant uniquement les fichiers essentiels au niveau du projet et les principaux répertoires organisationnels. Un répertoire <code>src/</code> de haut niveau sera utilisé pour le code source principal.</p>
                    
                    <h3 class="subsection-title">Arborescence Principale :</h3>
                    <div class="dir-structure">
                        <span class="folder">stockgenius_xau/</span><br>
                        ├── <span class="folder">.git/</span> <span class="comment"># Métadonnées Git</span><br>
                        ├── <span class="folder">src/</span> <span class="comment"># Code source principal</span><br>
                        ├── <span class="folder">data/</span> <span class="comment"># Ensembles de données</span><br>
                        ├── <span class="folder">configs/</span> <span class="comment"># Fichiers de configuration</span><br>
                        ├── <span class="folder">tests/</span> <span class="comment"># Tests automatisés</span><br>
                        ├── <span class="folder">notebooks/</span> <span class="comment"># Notebooks Jupyter</span><br>
                        ├── <span class="folder">scripts/</span> <span class="comment"># Scripts utilitaires</span><br>
                        ├── <span class="folder">docs/</span> <span class="comment"># Documentation</span><br>
                        ├── <span class="folder">models/</span> <span class="comment"># Modèles ML entraînés</span><br>
                        ├── <span class="folder">reports/</span> <span class="comment"># Rapports générés</span><br>
                        ├── <span class="folder">logs/</span> <span class="comment"># Fichiers journaux</span><br>
                        ├── <span class="folder">.venv/</span> <span class="comment"># Environnement virtuel (ignoré)</span><br>
                        ├── <span class="file">pyproject.toml</span> <span class="comment"># Métadonnées, dépendances</span><br>
                        ├── <span class="file">README.md</span> <span class="comment"># Aperçu du projet</span><br>
                        ├── <span class="file">.gitignore</span> <span class="comment"># Fichiers ignorés par Git</span><br>
                        ├── <span class="file">LICENSE</span> <span class="comment"># Licence du projet</span><br>
                        └── <span class="file">.env.template</span> <span class="comment"># Modèle pour variables d'environnement</span>
                    </div>

                    <h3 class="subsection-title mt-6">Tableau Récapitulatif des Répertoires Principaux :</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>Répertoire/Fichier</th><th>Objectif</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>src/</td><td>Code source principal de l'application (paquet Python).</td></tr>
                                <tr><td>data/</td><td>Ensembles de données (brutes, traitées, caractéristiques, entrées de modèle).</td></tr>
                                <tr><td>configs/</td><td>Fichiers de configuration (application, paramètres, environnements, secrets).</td></tr>
                                <tr><td>tests/</td><td>Tests automatisés (unitaires, d'intégration, etc.).</td></tr>
                                <tr><td>notebooks/</td><td>Notebooks Jupyter pour la recherche et l'expérimentation.</td></tr>
                                <tr><td>scripts/</td><td>Scripts shell/Python utilitaires et opérationnels.</td></tr>
                                <tr><td>docs/</td><td>Documentation du projet.</td></tr>
                                <tr><td>models/</td><td>Modèles entraînés sérialisés et artefacts associés.</td></tr>
                                <tr><td>reports/</td><td>Rapports générés, figures et résultats d'analyse.</td></tr>
                                <tr><td>logs/</td><td>Fichiers journaux de l'application.</td></tr>
                                <tr><td>.venv/</td><td>Environnement virtuel Python.</td></tr>
                                <tr><td>pyproject.toml</td><td>Métadonnées du projet, dépendances, configuration des outils.</td></tr>
                                <tr><td>README.md</td><td>Aperçu du projet, instructions de configuration et d'utilisation.</td></tr>
                                <tr><td>.gitignore</td><td>Spécifie les fichiers intentionnellement non suivis pour Git.</td></tr>
                                <tr><td>LICENSE</td><td>Informations sur la licence du projet.</td></tr>
                                <tr><td>.env.template</td><td>Modèle pour les variables d'environnement.</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="mt-4 text-slate-700 leading-relaxed">
                        Cette structure de haut niveau agit comme un contrat implicite pour l'équipe, facilitant la navigation et l'automatisation des processus MLOps.
                    </p>
                </div>
            </section>

            <section id="coeur-src" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">4. Le Cœur du Système : Organisation de <code>src/stockgenius_xau/</code></h2>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Le paquet principal au sein de <code>src/</code> devrait être nommé <code>stockgenius_xau</code>. Ce répertoire contiendra un fichier <code>__init__.py</code>, le transformant en un paquet Python. Les sous-modules seront organisés en fonction de la SoC et des couches de l'Architecture Propre. Les fichiers <code>__init__.py</code> peuvent être utilisés pour définir l'API publique de chaque module, renforçant l'encapsulation.
                    </p>
                </div>
            </section>

            <section id="src-common" class="content-section">
                <div class="content-card">
                    <h3 class="subsection-title">4.1. <code>src/stockgenius_xau/common/</code> (ou <code>utils/</code>, <code>core/shared/</code>)</h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Abrite le code partagé entre plusieurs modules ou couches de l'application mais n'appartenant pas à un domaine spécifique.</p>
                    <h4 class="block-title">Contenu Typique :</h4>
                    <ul class="styled-list">
                        <li><code>constants.py</code>: Constantes à l'échelle du projet.</li>
                        <li><code>custom_exceptions.py</code>: Classes d'exceptions personnalisées.</li>
                        <li><code>logging_config.py</code>: Configuration de la journalisation.</li>
                        <li><code>utils.py</code>: Fonctions utilitaires générales (éviter d'en faire un "fourre-tout").</li>
                    </ul>
                </div>
            </section>

            <section id="src-data-processing" class="content-section">
                <div class="content-card">
                    <h3 class="subsection-title">4.2. <code>src/stockgenius_xau/data_processing/</code></h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Modules responsables de l'ensemble du cycle de vie des données avant leur utilisation pour l'entraînement de modèles ou l'exécution de stratégies. S'aligne sur les étapes d'ingénierie des données en MLOps et peut être structuré comme des pipelines Kedro.</p>
                    <h4 class="block-title">Sous-répertoires/Modules Typiques :</h4>
                    <ul class="styled-list">
                        <li><code>ingestion/</code>: Scripts et classes pour récupérer les données (ex: <code>market_data_fetcher.py</code>).</li>
                        <li><code>validation/</code>: Logique de validation des données (ex: <code>data_validator.py</code>).</li>
                        <li><code>cleaning/</code>: Routines de nettoyage des données (ex: <code>data_cleaner.py</code>).</li>
                        <li><code>preprocessing/</code>: Transformations comme la normalisation, l'encodage (ex: <code>preprocessor.py</code>).</li>
                        <li><code>feature_engineering/</code>: Création de nouvelles caractéristiques (ex: <code>technical_indicators.py</code>).</li>
                        <li><code>labeling/</code> (si applicable): Scripts pour l'étiquetage des données.</li>
                    </ul>
                </div>
            </section>
            
            <section id="src-ml-models" class="content-section">
                <div class="content-card">
                    <h3 class="subsection-title">4.3. <code>src/stockgenius_xau/ml_models/</code></h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Tous les aspects du développement de modèles d'apprentissage automatique, de l'entraînement à l'évaluation et à la gestion. Composant MLOps essentiel.</p>
                    <h4 class="block-title">Sous-répertoires/Modules Typiques :</h4>
                    <ul class="styled-list">
                        <li><code>training/</code>: Scripts ou pipelines pour l'entraînement des modèles (ex: <code>train_price_prediction_model.py</code>).</li>
                        <li><code>evaluation/</code>: Scripts pour évaluer les modèles entraînés (ex: <code>model_evaluator.py</code>).</li>
                        <li><code>prediction/</code> (ou <code>inference/</code>): Fonctions pour faire des prédictions (ex: <code>predictor.py</code>).</li>
                        <li><code>drift_detection/</code>: Intégration avec des bibliothèques de détection de dérive (ex: Frouros).</li>
                        <li><code>model_management/</code>: Code pour interagir avec un registre de modèles (ex: MLflow Model Registry).</li>
                    </ul>
                </div>
            </section>

            <section id="src-trading-strategy" class="content-section page-break">
                <div class="content-card">
                    <h3 class="subsection-title">4.4. <code>src/stockgenius_xau/trading_strategy/</code></h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Encapsule la logique principale de la prise de décision en matière de trading.</p>
                    <h4 class="block-title">Sous-répertoires/Modules Typiques :</h4>
                    <ul class="styled-list">
                        <li><code>strategies/</code>: Implémentations de stratégies individuelles (ex: <code>mean_reversion_strategy.py</code>).</li>
                        <li><code>signals/</code>: Modules pour générer des signaux de trading (ex: <code>signal_generator.py</code>).</li>
                        <li><code>portfolio_construction/</code>: Logique d'allocation d'actifs et d'équilibrage de portefeuille.</li>
                        <li><code>risk_management/</code>: Composant Domaine Critique.
                            <ul class="styled-list">
                                <li><code>position_sizing.py</code></li>
                                <li><code>stop_loss_take_profit.py</code></li>
                                <li><code>pre_trade_checks.py</code></li>
                                <li><code>global_risk_limits.py</code></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section id="src-backtesting" class="content-section">
                <div class="content-card">
                    <h3 class="subsection-title">4.5. <code>src/stockgenius_xau/backtesting/</code></h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Frameworks et scripts pour tester rigoureusement les stratégies de trading sur des données historiques.</p>
                    <h4 class="block-title">Contenu Typique :</h4>
                    <ul class="styled-list">
                        <li><code>engine.py</code>: Boucle de backtesting principale, gestion des événements.</li>
                        <li><code>performance_metrics.py</code>: Calcul de métriques comme le ratio de Sharpe.</li>
                        <li><code>reporting.py</code>: Génération de rapports de backtest et de visualisations.</li>
                        <li>Intégration avec des bibliothèques comme VectorBT ou Zipline-Reloaded.</li>
                    </ul>
                </div>
            </section>

            <section id="src-execution" class="content-section">
                <div class="content-card">
                    <h3 class="subsection-title">4.6. <code>src/stockgenius_xau/execution/</code></h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Modules pour interagir avec les API des courtiers pour l'exécution des transactions en direct et la gestion des comptes.</p>
                    <h4 class="block-title">Contenu Typique :</h4>
                    <ul class="styled-list">
                        <li><code>broker_interfaces/</code>: Adaptateurs pour différents courtiers (ex: <code>metatrader5_interface.py</code>).</li>
                        <li><code>order_manager.py</code>: Gère la création, la soumission, le suivi et l'annulation des ordres.</li>
                        <li><code>account_manager.py</code>: Récupère le solde du compte, les positions, les informations sur la marge.</li>
                    </ul>
                </div>
            </section>

            <section id="src-main-cli" class="content-section">
                 <div class="content-card">
                    <h3 class="subsection-title">4.7. <code>src/stockgenius_xau/main.py</code> ou <code>cli.py</code></h3>
                    <h4 class="block-title">Objectif :</h4>
                    <p class="mb-2 text-slate-700 leading-relaxed">Script exécutable principal ou interface de ligne de commande (CLI) pour exécuter l'application (par exemple, lancer le trading live, un backtest spécifique, l'entraînement d'un modèle).</p>
                    <h4 class="block-title">Contenu Typique :</h4>
                    <ul class="styled-list">
                        <li>Analyse des arguments de la ligne de commande (par exemple, avec <code>argparse</code> ou <code>Click</code>).</li>
                        <li>Initialisation des composants principaux de l'application (configuration, logging, services).</li>
                        <li>Orchestration du flux d'exécution principal basé sur les commandes de l'utilisateur.</li>
                    </ul>
                    <p class="mt-4 text-slate-700 leading-relaxed">
                        La granularité de la modularité au sein de <code>src/</code> doit être guidée par le Principe de Responsabilité Unique. Cette isolation minimise les effets d'entraînement, rendant le système plus facile et plus sûr à mettre à jour.
                    </p>
                </div>
            </section>

            <section id="gestion-donnees-archi" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">5. Gestion des Données du Projet : Le Répertoire <code>data/</code></h2>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Ce répertoire centralise toutes les données utilisées et générées par le projet. Il est crucial que les données brutes soient immuables. Cette structure soutient la lignée des données et la reproductibilité, principes clés des MLOps.
                    </p>
                    <h3 class="subsection-title">Structure des Sous-répertoires Standard :</h3>
                    <div class="dir-structure">
                        <span class="folder">data/</span><br>
                        ├── <span class="folder">01_raw/</span> <span class="comment"># Dumps de données originaux, immuables.</span><br>
                        ├── <span class="folder">02_interim/</span> <span class="comment"># Données intermédiaires transformées.</span><br>
                        ├── <span class="folder">03_processed/</span> <span class="comment"># (ou primary/) Ensembles de données canoniques finaux.</span><br>
                        ├── <span class="folder">04_features/</span> <span class="comment"># Ensembles de données avec caractéristiques conçues.</span><br>
                        ├── <span class="folder">05_model_input/</span> <span class="comment"># Données pour entraînement/validation/test.</span><br>
                        ├── <span class="folder">07_model_output/</span> <span class="comment"># Sorties des prédictions des modèles.</span><br>
                        ├── <span class="folder">08_reporting/</span> <span class="comment"># Données pour rapports/visualisations.</span><br>
                        └── <span class="file">README.md</span> <span class="comment"># Description des sources, pipeline, schémas.</span>
                    </div>
                    <p class="mt-4 text-slate-700 leading-relaxed">
                        Pour le versionnement des données, l'utilisation de Data Version Control (DVC) est recommandée pour les fichiers volumineux. La structure numérotée reflète les étapes d'un pipeline de traitement, permettant de redémarrer à partir d'étapes intermédiaires valides.
                    </p>
                </div>
            </section>

            <section id="configs-secrets" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">6. Configuration, Secrets et Gestion de l'Environnement : Le Répertoire <code>configs/</code></h2>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Ce répertoire centralise toutes les configurations du projet pour éviter de coder en dur des valeurs. Cela améliore la maintenabilité, la sécurité et l'adaptabilité.
                    </p>
                    <h3 class="subsection-title">Structure Proposée :</h3>
                     <div class="dir-structure">
                        <span class="folder">configs/</span><br>
                        ├── <span class="file">settings.yaml</span> <span class="comment"># Paramètres principaux, globaux.</span><br>
                        ├── <span class="folder">parameters/</span><br>
                        │   ├── <span class="file">data_processing.yaml</span><br>
                        │   ├── <span class="file">model_training.yaml</span><br>
                        │   └── <span class="file">strategy_parameters.yaml</span><br>
                        ├── <span class="folder">environments/</span><br>
                        │   ├── <span class="file">development.yaml</span><br>
                        │   ├── <span class="file">testing.yaml</span><br>
                        │   └── <span class="file">production.yaml</span><br>
                        ├── <span class="file">secrets.dev.yaml</span> <span class="comment"># Secrets de dev (dans .gitignore !)</span><br>
                        ├── <span class="file">secrets.prod.yaml</span> <span class="comment"># Secrets de prod (dans .gitignore !)</span><br>
                        ├── <span class="file">logging.yaml</span> <span class="comment"># Configuration de la journalisation.</span><br>
                        └── <span class="file">catalog.yaml</span> <span class="comment"># (si Kedro) Définitions du catalogue de données.</span>
                    </div>
                    <p class="mt-4 text-slate-700 leading-relaxed">
                        Les fichiers de secrets (<code>secrets.*.yaml</code>) DOIVENT être dans <code>.gitignore</code>. Les valeurs sensibles sont chargées via des variables d'environnement en production ou un système de coffre-fort. Des bibliothèques comme OmegaConf ou Hydra peuvent gérer le chargement hiérarchique des configurations.
                    </p>
                </div>
            </section>

            <section id="qualite-repro" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">7. Assurer la Qualité et la Reproductibilité</h2>
                    <p class="mb-6 text-slate-700 leading-relaxed">Plusieurs répertoires et pratiques soutiennent la qualité du code, la reproductibilité des expériences et la documentation du projet.</p>
                    
                    <h3 class="subsection-title"><code>tests/</code> : Structure de la Suite de Tests</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Objectif : Assurer l'exactitude du code, prévenir les régressions. Structure reflétant <code>src/</code> (<code>unit/</code>, <code>integration/</code>, <code>functional/</code>). Utiliser <code>pytest</code> et simuler les dépendances externes.
                    </p>

                    <h3 class="subsection-title"><code>notebooks/</code> : Recherche et Prototypage</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Pour l'analyse exploratoire (EDA), le prototypage de stratégies, les expériences rapides. Organisation : <code>exploratory/</code>, <code>prototyping/</code>, <code>research/</code>. Refactoriser le code utile des notebooks dans <code>src/</code>.
                    </p>

                    <h3 class="subsection-title"><code>scripts/</code> : Scripts Utilitaires et Opérationnels</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Pour automatiser les tâches courantes (configuration d'environnement, linters, déploiement).
                    </p>
                    
                    <h3 class="subsection-title"><code>docs/</code> : Documentation du Projet</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Documentation complète pour la compréhension, la maintenance. Contenu : architecture technique, référence API (Sphinx), dictionnaire de données, guides de stratégie.
                    </p>

                    <h3 class="subsection-title"><code>models/</code> : Modèles Entraînés Persistés</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Stocker les modèles ML sérialisés et artefacts. Organisation par type/version. Versionnement avec MLflow Model Registry ou DVC.
                    </p>
                    
                    <h3 class="subsection-title"><code>reports/</code> : Sorties Générées</h3>
                    <p class="mb-4 text-slate-700 leading-relaxed">
                        Pour stocker les sorties d'analyses, backtests, évaluations de modèles (figures, rapports CSV/HTML).
                    </p>
                    <p class="mt-4 text-slate-700 leading-relaxed">
                        Une distinction claire entre le code dans <code>notebooks/</code>, <code>scripts/</code>, et <code>src/</code> est cruciale pour la qualité. Le code de production dans <code>src/</code> doit être testé et modulaire.
                    </p>
                </div>
            </section>

            <section id="integration-outils-archi" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">8. Intégration des Outils et Frameworks</h2>
                    <p class="mb-6 text-slate-700 leading-relaxed">L'architecture s'appuie sur divers outils pour une gestion efficace du projet.</p>
                    <ul class="styled-list">
                        <li><strong>Gestion des Dépendances (<code>pyproject.toml</code>) :</strong> Utiliser Poetry ou PDM. <code>pyproject.toml</code> définit les métadonnées, dépendances et configurations d'outils (Black, Flake8, pytest).</li>
                        <li><strong>Environnements Virtuels :</strong> Essentiels pour isoler les dépendances (<code>.venv/</code> dans <code>.gitignore</code>).</li>
                        <li><strong>Intégration MLflow :</strong> Pour le suivi d'expériences, le registre de modèles et les projets MLflow (reproductibilité). Répertoire <code>mlruns/</code> local ou serveur distant.</li>
                        <li><strong>Intégration Kedro :</strong> Pour structurer les pipelines de données et ML (nœuds, pipelines, catalogue de données). Plugin <code>kedro-mlflow</code> pour une intégration aisée.</li>
                        <li><strong>Intégration DVC (Data Version Control) :</strong> Pour versionner les fichiers de données volumineux et les modèles parallèlement au code Git.</li>
                        <li><strong>Configuration de la Journalisation (Logging) :</strong> Utiliser le module <code>logging</code> de Python, configurable via <code>configs/logging.yaml</code>. Journaliser méticuleusement toutes les opérations critiques.</li>
                    </ul>
                    <p class="mt-4 text-slate-700 leading-relaxed">
                        L'intégration harmonieuse de ces outils (Poetry, Git, DVC, Kedro, MLflow, etc.) est clé pour une plateforme MLOps puissante et synergique, en définissant des responsabilités claires pour chaque outil.
                    </p>
                </div>
            </section>

            <section id="conclusion-archi" class="content-section page-break">
                <div class="content-card">
                    <h2 class="section-title">9. Conclusion et Recommandations</h2>
                    <p class="mb-4 text-slate-700 leading-relaxed text-lg">
                        L'architecture proposée, caractérisée par sa modularité, la séparation des préoccupations, des étapes de données claires, une configuration robuste et l'intégration d'outils MLOps, répond directement aux besoins de 'StockGenius XAU' en matière de maintenabilité, de scalabilité, de reproductibilité et de collaboration.
                    </p>
                    <h3 class="subsection-title">Étapes Clés pour la Mise en Œuvre :</h3>
                    <ul class="styled-list">
                        <li>Commencer par la structure de répertoires de haut niveau et <code>pyproject.toml</code> (avec Poetry).</li>
                        <li>Implémenter les utilitaires de base dans <code>common/</code>, y compris la configuration de la journalisation.</li>
                        <li>Mettre en place le répertoire <code>configs/</code> et un mécanisme de base pour le chargement de la configuration.</li>
                        <li>Développer un pipeline de données simple dans <code>src/data_processing/</code> (envisager Kedro dès le début).</li>
                        <li>Développer les modèles ML initiaux dans <code>src/ml_models/</code>, en intégrant rapidement le suivi MLflow.</li>
                        <li>Implémenter une stratégie de trading de base et une configuration de backtesting.</li>
                        <li>Ajouter itérativement des composants, en respectant la structure et les principes définis.</li>
                        <li>Établir des pratiques de CI/CD et de test dès le début du projet.</li>
                    </ul>
                    <p class="mt-4 text-slate-700 leading-relaxed text-lg">
                        L'architecture proposée constitue une base solide mais doit pouvoir évoluer. Elle doit être traitée comme un "document vivant", versionné et revu périodiquement. Des examens et des refactorisations réguliers sont nécessaires pour maintenir l'intégrité architecturale à mesure que le projet se développe.
                    </p>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const reportNavigation = document.getElementById('report-navigation');
            
            function showSection(targetId) {
                contentSections.forEach(section => {
                    section.classList.toggle('active', section.id === targetId);
                });
            }
            
            function updateActiveLink(targetId) {
                 navLinks.forEach(navLink => {
                    navLink.classList.toggle('active', navLink.dataset.target === targetId);
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', function (event) {
                    event.preventDefault();
                    const targetId = this.dataset.target;
                    
                    history.pushState(null, null, '#' + targetId); 
                    showSection(targetId);
                    updateActiveLink(targetId);
                    
                    const linkRect = this.getBoundingClientRect();
                    const navRect = reportNavigation.getBoundingClientRect();
                    if (linkRect.bottom > navRect.bottom) {
                        reportNavigation.scrollTop += (linkRect.bottom - navRect.bottom) + 20;
                    } else if (linkRect.top < navRect.top) {
                         reportNavigation.scrollTop -= (navRect.top - linkRect.top) + 20;
                    }
                });
            });
            
            function loadSectionFromHash() {
                let initialTargetId = 'intro-archi'; // Section par défaut pour ce rapport
                if (window.location.hash) {
                    const hashTarget = window.location.hash.substring(1);
                    const targetElement = document.getElementById(hashTarget);
                    if (targetElement && targetElement.classList.contains('content-section')) {
                        initialTargetId = hashTarget;
                    }
                }
                showSection(initialTargetId);
                updateActiveLink(initialTargetId);
                 // S'assurer que le lien actif est visible au chargement
                const activeLink = reportNavigation.querySelector('.nav-link.active');
                if (activeLink) {
                    const linkRect = activeLink.getBoundingClientRect();
                    const navRect = reportNavigation.getBoundingClientRect();
                     if (linkRect.bottom > navRect.bottom || linkRect.top < navRect.top) {
                        activeLink.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }

            loadSectionFromHash();
            window.addEventListener('hashchange', loadSectionFromHash);
        });
    </script>
</body>
</html>
